
SUBROUTINE Lagrange_Coeff(NP,SRm,dSR,WM)
!-------------------------------------------------------------------------------------------

  IMPLICIT NONE
  
  INTEGER(KIND=4) :: NP
  REAL   (KIND=8) :: SRm,dSR,WM(0:NP,0:NP)
  
  INTEGER(KIND=4) :: P,K,II
  REAL   (KIND=8) :: AMul,CSum,Xnd(NP),Rnd(0:NP)
!-------------------------------------------------------------------------------------------  

         
                                                              
                !-------------------------------------------------------------
                Xnd(:)=0.D0;                             Rnd(:)=0.D0
                !-------------------------------------------------------------
                DO II=0,NP
                   !---------------------------------------------------------- 
                   Rnd(II)=SRm-0.5*dSR+II*dSR/NP
                   !---------------------------------------------------------- 
                END DO
                !-------------------------------------------------------------
                DO K=0,NP
                   !---------------------------------------------------------- 
                   AMul=1.D0
                   !---------------------------------------------------------- 
                   DO II=0,K-1
                      !------------------------------------------------------- 
                      AMul=AMul*(Rnd(K)-Rnd(II));  Xnd(II+1)=Rnd(II) 
                      !------------------------------------------------------- 
                   END DO
                   !---------------------------------------------------------- 
                   DO II=K+1,NP
                      !-------------------------------------------------------  
                      AMul=AMul*(Rnd(K)-Rnd(II));  Xnd(II)=Rnd(II) 
                      !-------------------------------------------------------  
                   END DO
                   !---------------------------------------------------------- 
                   DO P=0,NP
                      !-------------------------------------------------------  
                      CALL Lagrange(P,NP,Xnd,CSum)
                      !------------------------------------------------------- 
                      WM(P,K)=CSum/AMul
                      !------------------------------------------------------- 
                   END DO
                   !---------------------------------------------------------- 
                END DO
                !-------------------------------------------------------------
                
              
               
                
!-------------------------------------------------------------------------------------------
                                                                                    RETURN
END SUBROUTINE
!===========================================================================================
    
    
    