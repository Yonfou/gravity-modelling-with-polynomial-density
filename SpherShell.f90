
SUBROUTINE SperShell(Typ,NT,T,A,B,C,SpC,SpR,PR,PF,PL,NPR,NPF,NPL,GV0,GA0,GG0)
!-------------------------------------------------------------------------------------------


  IMPLICIT NONE

  INTEGER(KIND=4) :: Typ,NT,NPR,NPF,NPL
  REAL   (KIND=8) :: T(0:NT),A,B,C,SpC(3),SpR(2),PR(NPR),PF(NPF),PL(NPL)
  REAL   (KIND=8) :: GV0(NPR,NPF,NPL),GA0(3,NPR,NPF,NPL),GG0(6,NPR,NPF,NPL)
  
  INTEGER(KIND=4) :: I,J,K
  REAL   (KIND=8) :: G0,M,PI,COSF,X(3),L,L2,L3,L5,GAMA
  REAL   (KIND=8) :: GVs,GAs(3),GGs(6)
!-------------------------------------------------------------------------------------------  

                
                
  
                                                            
                !-------------------------------------------------------------
                G0=6.674D-11                                    
                !-------------------------------------------------------------
                PI=3.141592653589793238462643383279D0           
                !-------------------------------------------------------------
                IF(Typ==1) THEN
                    !---------------------------------------------------------
                    GAMA=0.D0
                    !---------------------------------------------------------
                    DO I=0,NT
                       !------------------------------------------------------ 
                       GAMA=GAMA+T(I)/(I+3.)*(SpR(2)**(I+3)-SpR(1)**(I+3))
                       !------------------------------------------------------ 
                    END DO
                    !---------------------------------------------------------
                ELSEIF(Typ==2) THEN
                    !---------------------------------------------------------
                    GAMA=A/B**3*((SpR(1)**2*B**2+2.*SpR(1)*B+2.) - (SpR(2)**2*B**2+2.*SpR(2)*B+2.)*EXP(-B*(SpR(2)-SpR(1)))) + C*(SpR(2)**3-SpR(1)**3)/3.D0
                    !---------------------------------------------------------
                ENDIF
                !-------------------------------------------------------------
                
                
                
                                                                                  
                !-------------------------------------------------------------
                M=4.*PI*G0*GAMA
                !-------------------------------------------------------------
                OPEN(1,FILE='Shell_Exponential_Ana.dat',STATUS='UNKNOWN')
                   !----------------------------------------------------------
                   DO J=1,NPF
                   DO K=1,NPL
                   DO I=1,NPR
                      !------------------------------------------------------- 
                      COSF=SIN(PF(J))*SIN(SpC(2))+COS(PF(J))*COS(SpC(2))*COS(PL(K)-SpC(3))
                      !------------------------------------------------------- 
                      X(1)=SpC(1)*(COS(PF(J))*SIN(SpC(2))-SIN(PF(J))*COS(SpC(2))*COS(PL(K)-SpC(3)))
                      X(2)=SpC(1)*COS(SpC(2))*SIN(PL(K)-SpC(3))
                      X(3)=SpC(1)*COSF-PR(I)
                      !------------------------------------------------------- 
                      L=SQRT(SUM(X(:)**2));    L2=L**2;    L3=L**3;    L5=L**5
                      !-------------------------------------------------------
                      GVs=M/L                                !--V
                      !-------------------------------------------------------
                      GAs(1)=M*X(1)/L3                       !--Gx
                      GAs(2)=M*X(2)/L3                       !--Gy
                      GAs(3)=M*X(3)/L3                       !--Gz
                      !-------------------------------------------------------
                      GGs(1)=M*(3.*X(1)**2-L2)/L5            !--Gxx
                      GGs(2)=M*(3.*X(2)**2-L2)/L5            !--Gyy
                      GGs(3)=M*(3.*X(3)**2-L2)/L5            !--Gzz
                      GGs(4)=M*(3.*X(1)*X(2))/L5             !--Gxy
                      GGs(5)=M*(3.*X(1)*X(3))/L5             !--Gxz
                      GGs(6)=M*(3.*X(2)*X(3))/L5             !--Gyz
                      !-------------------------------------------------------
                      GV0(I,J,K)=GVs; GA0(:,I,J,K)=GAs(:); GG0(:,I,J,K)=GGs(:)
                      !-------------------------------------------------------
                      WRITE(1,'(15(F30.18,F30.18))') PR(I),PL(K),PF(J),&
                                                       & GVs,GAs(1),GAs(2),GAs(3), &
                                                       & GGs(1),GGs(2),GGs(3), &
                                                       & GGs(4),GGs(5),GGs(6)
                      !-------------------------------------------------------
                   END DO
                   END DO
                   END DO
                   !----------------------------------------------------------
                CLOSE(1)
                !-------------------------------------------------------------
  

  
!-------------------------------------------------------------------------------------------
                                                                                    RETURN
END SUBROUTINE
!===========================================================================================