
SUBROUTINE WeightCoef1(NP,Norm,NPL,NSL,PR0,PF0,PL,SR0,SF0,SL,dSR,dSF,dSL,MV,MA,MG,WM)
!-------------------------------------------------------------------------------------------
  IMPLICIT NONE
  
  INTEGER(KIND=4) :: KK,II,NP,NPL,NSL
  REAL   (KIND=8) :: Norm,PR0,PF0,PL(NPL),SR0,SF0,SL(NSL),dSR,dSF,dSL,WM(0:NP,0:NP)
  REAL   (KIND=8) :: MV(NPL+NSL,0:NP),MA(NPL+NSL,0:NP,3),MG(NPL+NSL,0:NP,6)
  REAL   (KIND=8) :: IV(0:NP),IA(0:NP,3),IG(0:NP,6)
!-------------------------------------------------------------------------------------------  
               
  
  
  
                                                           
                !-------------------------------------------------------------
                MV(:,:)=0.D0;          MA(:,:,:)=0.D0;          MG(:,:,:)=0.D0 
                !-------------------------------------------------------------  
                

       
                !-------------------------------------------------------------  
                DO KK=1,NPL
                       !------------------------------------------------------          
                       CALL AdaptiveDiscre(NP,Norm,PR0,PF0,PL(KK),SR0,SF0,SL(1),dSR,dSF,dSL,IV,IA,IG)
                       !------------------------------------------------------
                       DO II=0,NP
                          !---------------------------------------------------  
                          MV(KK,II)=SUM(WM(:,II)*IV(:)) 
                          !--------------------------------------------------- 
                          MA(KK,II,1)=SUM(WM(:,II)*IA(:,1))
                          MA(KK,II,2)=SUM(WM(:,II)*IA(:,2))
                          MA(KK,II,3)=SUM(WM(:,II)*IA(:,3))
                          !--------------------------------------------------- 
                          MG(KK,II,1)=SUM(WM(:,II)*IG(:,1))
                          MG(KK,II,2)=SUM(WM(:,II)*IG(:,2))
                          MG(KK,II,3)=SUM(WM(:,II)*IG(:,3))
                          MG(KK,II,4)=SUM(WM(:,II)*IG(:,4))
                          MG(KK,II,5)=SUM(WM(:,II)*IG(:,5))
                          MG(KK,II,6)=SUM(WM(:,II)*IG(:,6))
                          !---------------------------------------------------
                       END DO
                       !------------------------------------------------------
                END DO
                !-------------------------------------------------------------
                
             
            
                !-------------------------------------------------------------  
                DO KK=2,NSL
                       !------------------------------------------------------         
                       CALL AdaptiveDiscre(NP,Norm,PR0,PF0,PL(1),SR0,SF0,SL(NSL-KK+2),dSR,dSF,dSL,IV,IA,IG) 
                       !-------------------------------------------------------
                       DO II=0,NP
                          !----------------------------------------------------  
                          MV(NPL+KK,II)=SUM(WM(:,II)*IV(:)) 
                          !---------------------------------------------------- 
                          MA(NPL+KK,II,1)=SUM(WM(:,II)*IA(:,1))
                          MA(NPL+KK,II,2)=SUM(WM(:,II)*IA(:,2))
                          MA(NPL+KK,II,3)=SUM(WM(:,II)*IA(:,3))
                          !---------------------------------------------------- 
                          MG(NPL+KK,II,1)=SUM(WM(:,II)*IG(:,1))
                          MG(NPL+KK,II,2)=SUM(WM(:,II)*IG(:,2))
                          MG(NPL+KK,II,3)=SUM(WM(:,II)*IG(:,3))
                          MG(NPL+KK,II,4)=SUM(WM(:,II)*IG(:,4))
                          MG(NPL+KK,II,5)=SUM(WM(:,II)*IG(:,5))
                          MG(NPL+KK,II,6)=SUM(WM(:,II)*IG(:,6))
                          !----------------------------------------------------
                       END DO
                       !-------------------------------------------------------
                END DO
                !--------------------------------------------------------------
                
                
                
               
                
!-------------------------------------------------------------------------------------------
                                                                                    RETURN
END SUBROUTINE
!===========================================================================================