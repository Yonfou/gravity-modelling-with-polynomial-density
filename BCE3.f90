
SUBROUTINE BCE3(NR,NC,T,S,F)
!-------------------------------------------------------------------------------------------

  IMPLICIT NONE

  INTEGER(KIND=4) :: N,NC,NR
  REAL   (KIND=8) :: T(NR+NC),S(NR),F(NC)
  COMPLEX(KIND=8),ALLOCATABLE :: H(:),R(:)
  
!-------------------------------------------------------------------------------------------  

              
                                       
                !-------------------------------------------------------------
                N=NC+NR
                !-------------------------------------------------------------
                ALLOCATE(H(N));                     H(:)=0.D0
                ALLOCATE(R(N));                     R(:)=0.D0
                !-------------------------------------------------------------
                
                                                                                
                !-------------------------------------------------------------
                H(:)=T(:);    H(NC+1)=0.D0;        R(1:NR)=S(:)
                !-------------------------------------------------------------
                CALL FFT_1D(N,H,1)
                CALL FFT_1D(N,R,1)
                !-------------------------------------------------------------
                H=H*R;  CALL FFT_1D(N,H,-1)
                !-------------------------------------------------------------
                F(:)=H(1:NC)
                !-------------------------------------------------------------
  
 

                                  
                !-------------------------------------------------------------
                DEALLOCATE(H,R)
                !-------------------------------------------------------------
                
                
                
!-------------------------------------------------------------------------------------------
                                                                                    RETURN
END SUBROUTINE
!===========================================================================================